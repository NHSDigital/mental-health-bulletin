# Databricks notebook source
 %sql
 ---insert lower ethnicity codes, gender codes for each higher ethnicity into $db_output.NHSDEthnicityDim
 TRUNCATE TABLE $db_output.NHSDEthnicityDim;
 INSERT INTO $db_output.NHSDEthnicityDim VALUES
 ('A', '1', 'White', 1, 1),
 ('B', '1', 'White', 2, 1),
 ('C', '1', 'White', 3, 1),
 ('D', '2', 'Mixed', 4, 2),
 ('E', '2', 'Mixed', 5, 2),
 
 ('F', '2', 'Mixed', 6, 2),
 ('G', '2', 'Mixed', 7, 2),
 ('H', '3', 'Asian', 8, 3),
 ('J', '3', 'Asian', 9, 3),
 ('K', '3', 'Asian', 10, 3),
 ('L', '3', 'Asian', 11, 3),
 ('M', '4', 'Black', 12, 4),
 ('N', '4', 'Black', 13, 4),
 ('P', '4', 'Black', 14, 4),
 ('R', '5', 'Other', 15, 5), -- Chinese
 ('S', '5', 'Other', 16, 5),
 ('Not Stated', '6', 'Not Stated', 17, 6),
 ('Not Known', '7', 'Not Known', 18, 7),
 ('Unknown', '8', 'Unknown', 19, 8)

# COMMAND ----------

 %sql
 TRUNCATE TABLE $db_output.ref_master;
 INSERT INTO $db_output.ref_master VALUES
 ---insert all possible level values for each breakdown for output csv
 -- England --
 ('England', 'England', 'England'),
 
 -- PROVIDER_TYPE --
 ('PROVIDER_TYPE', 'NHS', 'NHS Providers'),
 ('PROVIDER_TYPE', 'Non NHS', 'Non NHS Providers'),
 
  -- CCG - Registration or Residence -- known code and names added later
  ('CCG - Registration or Residence','Unknown', 'Unknown'),
 
  -- LADUA -- known code and names added later
 ('LADUA','L99999999', 'Channel Island'),
 ('LADUA','M99999999', 'Isle of Man'),
 ('LADUA','X99999998', 'Not applicable (outside the United Kingdom)'),
 ('LADUA','N', 'Northern Ireland'),
 ('LADUA','W', 'Wales'),
 ('LADUA','S', 'Scotland'),
 ('LADUA','Unknown', 'Unknown'),
 
 -- SUPERCLASS --
 ('SUPERCLASS','Non Psychotic', 'Non-psychotic'),
 ('SUPERCLASS','Psychotic', 'Psychotic'),
 ('SUPERCLASS','Organic', 'Organic'),
 ('SUPERCLASS','Unknown', 'Unknown'),
 
 -- AGE_HL --
 ('AGE_HL','Under 18', 'People aged under 18'),
 ('AGE_HL','18 and over', 'People aged 18 or over'),
 ('AGE_HL','Unknown', 'Unknown'),
 
 -- AGE_LL --
 ('AGE_LL','Under 14', 'Under 14'),
 ('AGE_LL','14 to 15', '14 to 15'),
 ('AGE_LL','16 to 17', '16 to 17'),
 ('AGE_LL','18 to 19', '18 to 19'),
 ('AGE_LL','20 to 24', '20 to 24'),
 ('AGE_LL','25 to 29', '25 to 29'),
 ('AGE_LL','30 to 34', '30 to 34'),
 ('AGE_LL','35 to 39', '35 to 39'),
 ('AGE_LL','40 to 44', '40 to 44'),
 ('AGE_LL','45 to 49', '45 to 49'),
 ('AGE_LL','50 to 54', '50 to 54'),
 ('AGE_LL','55 to 59', '55 to 59'),
 ('AGE_LL','60 to 64', '60 to 64'),
 ('AGE_LL','65 to 69', '65 to 69'),
 ('AGE_LL','70 to 74', '70 to 74'),
 ('AGE_LL','75 to 79', '75 to 79'),
 ('AGE_LL','80 to 84', '80 to 84'),
 ('AGE_LL','85 to 89', '85 to 89'),
 ('AGE_LL','90 or over', '90 or over'),
 ('AGE_LL','Unknown', 'Unknown'),
 
 -- AGE_LL_T1 --
 ('AGE_LL_T1','0 to 5', '0 to 5'),
 ('AGE_LL_T1','6 to 10', '6 to 10'),
 ('AGE_LL_T1','11 to 15', '11 to 15'),
 ('AGE_LL_T1','16', '16'),
 ('AGE_LL_T1','17', '17'),
 ('AGE_LL_T1','18', '18'),
 ('AGE_LL_T1','19', '19'),
 ('AGE_LL_T1','20 to 24', '20 to 24'),
 ('AGE_LL_T1','25 to 29', '25 to 29'),
 ('AGE_LL_T1','30 to 34', '30 to 34'),
 ('AGE_LL_T1','35 to 39', '35 to 39'),
 ('AGE_LL_T1','40 to 44', '40 to 44'),
 ('AGE_LL_T1','45 to 49', '45 to 49'),
 ('AGE_LL_T1','50 to 54', '50 to 54'),
 ('AGE_LL_T1','55 to 59', '55 to 59'),
 ('AGE_LL_T1','60 to 64', '60 to 64'),
 ('AGE_LL_T1','65 to 69', '65 to 69'),
 ('AGE_LL_T1','70 to 74', '70 to 74'),
 ('AGE_LL_T1','75 to 79', '75 to 79'),
 ('AGE_LL_T1','80 to 84', '80 to 84'),
 ('AGE_LL_T1','85 to 89', '85 to 89'),
 ('AGE_LL_T1','90 or over', '90 or over'),
 ('AGE_LL_T1','Unknown', 'Unknown'),
 
 -- AGE_LL_CYP --
 ('AGE_LL_CYP','0 to 5', '0 to 5'),
 ('AGE_LL_CYP','6 to 10', '6 to 10'),
 ('AGE_LL_CYP','11 to 15', '11 to 15'),
 ('AGE_LL_CYP','16', '16'),
 ('AGE_LL_CYP','17', '17'),
 ('AGE_LL_CYP','Unknown', 'Unknown'),
 
 -- AGE_LL_cluster --
 ('AGE_LL_cluster','Under 18', 'Under 18'),
 ('AGE_LL_cluster','18 to 19', '18 to 19'),
 ('AGE_LL_cluster','20 to 24', '20 to 24'),
 ('AGE_LL_cluster','25 to 29', '25 to 29'),
 ('AGE_LL_cluster','30 to 34', '30 to 34'),
 ('AGE_LL_cluster','35 to 39', '35 to 39'),
 ('AGE_LL_cluster','40 to 44', '40 to 44'),
 ('AGE_LL_cluster','45 to 49', '45 to 49'),
 ('AGE_LL_cluster','50 to 54', '50 to 54'),
 ('AGE_LL_cluster','55 to 59', '55 to 59'),
 ('AGE_LL_cluster','60 to 64', '60 to 64'),
 ('AGE_LL_cluster','65 to 69', '65 to 69'),
 ('AGE_LL_cluster','70 to 74', '70 to 74'),
 ('AGE_LL_cluster','75 to 79', '75 to 79'),
 ('AGE_LL_cluster','80 to 84', '80 to 84'),
 ('AGE_LL_cluster','85 to 89', '85 to 89'),
 ('AGE_LL_cluster','90 or over', '90 or over'),
 ('AGE_LL_cluster','Unknown', 'Unknown'),
 
 -- EIP_Age_LL_cluster --
 ('EIP_Age_LL','0 to 13', '0 to 13'),
 ('EIP_Age_LL','14 to 17', '14 to 17'),
 ('EIP_Age_LL','18 to 19', '18 to 19'),
 ('EIP_Age_LL','20 to 24', '20 to 24'),
 ('EIP_Age_LL','25 to 29', '25 to 29'),
 ('EIP_Age_LL','30 to 34', '30 to 34'),
 ('EIP_Age_LL','35 to 39', '35 to 39'),
 ('EIP_Age_LL','40 to 44', '40 to 44'),
 ('EIP_Age_LL','45 to 49', '45 to 49'),
 ('EIP_Age_LL','50 to 54', '50 to 54'),
 ('EIP_Age_LL','55 to 59', '55 to 59'),
 ('EIP_Age_LL','60 to 64', '60 to 64'),
 ('EIP_Age_LL','65 to 69', '65 to 69'),
 ('EIP_Age_LL','70 to 74', '70 to 74'),
 ('EIP_Age_LL','75 to 79', '75 to 79'),
 ('EIP_Age_LL','80 to 84', '80 to 84'),
 ('EIP_Age_LL','85 to 89', '85 to 89'),
 ('EIP_Age_LL','90 or over', '90 or over'),
 ('EIP_Age_LL','Unknown', 'Unknown'),
 
 -- AGE_LL_restraint --
 ('AGE_LL_restraint','Under 18', 'Under 18'),
 ('AGE_LL_restraint','18 to 24', '18 to 24'),
 ('AGE_LL_restraint','25 to 29', '25 to 29'),
 ('AGE_LL_restraint','30 to 34', '30 to 34'),
 ('AGE_LL_restraint','35 to 39', '35 to 39'),
 ('AGE_LL_restraint','40 to 44', '40 to 44'),
 ('AGE_LL_restraint','45 to 49', '45 to 49'),
 ('AGE_LL_restraint','50 to 54', '50 to 54'),
 ('AGE_LL_restraint','55 to 59', '55 to 59'),
 ('AGE_LL_restraint','60 or over', '60 or over'),
 ('AGE_LL_restraint','Unknown', 'Unknown'),
 
 -- AGE_LL_perinatal --
 ('AGE_LL_perinatal','Under 15', 'Under 15'),
 ('AGE_LL_perinatal','15 to 19', '15 to 19'),
 ('AGE_LL_perinatal','20 to 24', '20 to 24'),
 ('AGE_LL_perinatal','25 to 29', '25 to 29'),
 ('AGE_LL_perinatal','30 to 34', '30 to 34'),
 ('AGE_LL_perinatal','35 to 39', '35 to 39'),
 ('AGE_LL_perinatal','40 to 44', '40 to 44'),
 ('AGE_LL_perinatal','45 to 49', '45 to 49'),
 ('AGE_LL_perinatal','50 to 54', '50 to 54'),
 ('AGE_LL_perinatal','55 to 59', '55 to 59'),
 ('AGE_LL_perinatal','60 to 64', '60 to 64'),
 ('AGE_LL_perinatal','65 and over', '65 and over'),
 ('AGE_LL_perinatal','Unknown', 'Unknown'),
 
 -- AGE_LL_72hfollow --
 ('AGE_LL_72hfollow','Under 18', 'Under 18'),
 ('AGE_LL_72hfollow','18 to 19', '18 to 19'),
 ('AGE_LL_72hfollow','20 to 24', '20 to 24'),
 ('AGE_LL_72hfollow','25 to 29', '25 to 29'),
 ('AGE_LL_72hfollow','30 to 34', '30 to 34'),
 ('AGE_LL_72hfollow','35 to 39', '35 to 39'),
 ('AGE_LL_72hfollow','40 to 44', '40 to 44'),
 ('AGE_LL_72hfollow','45 to 49', '45 to 49'),
 ('AGE_LL_72hfollow','50 to 54', '50 to 54'),
 ('AGE_LL_72hfollow','55 to 59', '55 to 59'),
 ('AGE_LL_72hfollow','60 to 64', '60 to 64'),
 ('AGE_LL_72hfollow','65 to 69', '65 to 69'),
 ('AGE_LL_72hfollow','70 to 74', '70 to 74'),
 ('AGE_LL_72hfollow','75 to 79', '75 to 79'),
 ('AGE_LL_72hfollow','80 to 84', '80 to 84'),
 ('AGE_LL_72hfollow','85 to 89', '85 to 89'),
 ('AGE_LL_72hfollow','90 and over', '90 and over'),
 ('AGE_LL_72hfollow','Unknown', 'Unknown'),
 
 -- GENDER --
 ('GENDER','1', 'Male'),
 ('GENDER','2', 'Female'),
 ('GENDER','3', 'Non-binary'),
 ('GENDER','4', 'Other (not listed)'),
 ('GENDER','9', 'Indeterminate'),
 ('GENDER','Unknown', 'Unknown'),
 
 -- ETHNIC_HL -- 
 ('ETHNIC_HL','White', 'White'),
 ('ETHNIC_HL','Mixed', 'Mixed'),
 ('ETHNIC_HL','Asian or Asian British', 'Asian or Asian British'),
 ('ETHNIC_HL','Black or Black British', 'Black or Black British'),
 ('ETHNIC_HL','Other Ethnic Groups', 'Other Ethnic Groups'),
 ('ETHNIC_HL','Not Stated', 'Not Stated'),
 ('ETHNIC_HL','Not Known', 'Not Known'),
 ('ETHNIC_HL','Unknown', 'Unknown'),
 
 -- ETHNIC_LL --
 ('ETHNIC_LL','A', 'British'),
 ('ETHNIC_LL','B', 'Irish'),
 ('ETHNIC_LL','C', 'Any Other White background'),
 ('ETHNIC_LL','D', 'White and Black Caribbean'),
 ('ETHNIC_LL','E', 'White and Black African'),
 ('ETHNIC_LL','F', 'White and Asian'),
 ('ETHNIC_LL','G', 'Any Other mixed background'),
 ('ETHNIC_LL','H', 'Indian'),
 ('ETHNIC_LL','J', 'Pakistani'),
 ('ETHNIC_LL','K', 'Bangladeshi'),
 ('ETHNIC_LL','L', 'Any Other Asian background'),
 ('ETHNIC_LL','M', 'Caribbean'),
 ('ETHNIC_LL','N', 'African'),
 ('ETHNIC_LL','P', 'Any Other Black background'),
 ('ETHNIC_LL','R', 'Chinese'),
 ('ETHNIC_LL','S', 'Any Other Ethnic Group'),
 ('ETHNIC_LL','Not Stated', 'Not Stated'),
 ('ETHNIC_LL','Not Known', 'Not Known'),
 ('ETHNIC_LL','Unknown', 'Unknown'),
 
 -- ATTENDANCE --
 ('ATTENDANCE','5', 'Attended on time or, if late, before the relevant professional was ready to see the patient'),
 ('ATTENDANCE','6', 'Arrived late, after the relevant professional was ready to see the patient, but was seen'),
 ('ATTENDANCE','7', 'Patient arrived late and could not be seen'),
 ('ATTENDANCE','2', 'Appointment cancelled by, or on behalf of the patient'),
 ('ATTENDANCE','3', 'Did not attend, no advance warning given'),
 ('ATTENDANCE','4', 'Appointment cancelled or postponed by the health care provider'),
 ('ATTENDANCE','Unknown', 'Unknown'),
 
 -- STP -- known code and names added later
 ('STP', 'Unknown', 'Unknown'),
 
 -- COMM_REGION -- known code and names added later
 ('COMM_REGION', 'Unknown', 'Unknown'),
 
 -- SERVICE_TEAM --
 ('SERVICE_TEAM','A01', 'Day Care Service'),
 ('SERVICE_TEAM','A02', 'Crisis Resolution Team/Home Treatment Service'),
 ('SERVICE_TEAM','A03', 'Crisis Resolution Team'),
 ('SERVICE_TEAM','A04', 'Home Treatment Service'),
 ('SERVICE_TEAM','A05', 'Primary Care Mental Health Service'),
 ('SERVICE_TEAM','A06', 'Community Mental Health Team - Functional'),
 ('SERVICE_TEAM','A07', 'Community Mental Health Team - Organic'),
 ('SERVICE_TEAM','A08', 'Assertive Outreach Team'),
 ('SERVICE_TEAM','A09', 'Rehabilitation & Recovery Service'),
 ('SERVICE_TEAM','A10', 'General Psychiatric Service'),
 ('SERVICE_TEAM','A11', 'Psychiatric Liaison Service'),
 ('SERVICE_TEAM','A12', 'Psychotherapy Service'),
 ('SERVICE_TEAM','A13', 'Psychological Therapy Service (non IAPT),'),
 ('SERVICE_TEAM','A14', 'Early Intervention Team for Psychosis'),
 ('SERVICE_TEAM','A15', 'Young Onset Dementia Team'),
 ('SERVICE_TEAM','A16', 'Personality Disorder Service'),
 ('SERVICE_TEAM','A17', 'Memory Services/Clinic'),
 ('SERVICE_TEAM','A18', 'Single Point of Access Service'),
 ('SERVICE_TEAM','A19', '24/7 Crisis Response Line'),
 ('SERVICE_TEAM','A20', 'Health Based Place Of Safety Service'),
 ('SERVICE_TEAM','B01', 'Forensic Mental Health Service'),
 ('SERVICE_TEAM','B02', 'Forensic Learning Disability Service'),
 ('SERVICE_TEAM','C01', 'Autistic Spectrum Disorder Service'),
 ('SERVICE_TEAM','C02', 'Peri-Natal Mental Illness Service'),
 ('SERVICE_TEAM','C03', 'Eating Disorders/Dietetics Service'),
 ('SERVICE_TEAM','C04', 'Neurodevelopment Team'),
 ('SERVICE_TEAM','C05', 'Paediatric Liaison Service'),
 ('SERVICE_TEAM','C06', 'Looked After Children Service'),
 ('SERVICE_TEAM','C07', 'Community Young Offenders Service'),
 ('SERVICE_TEAM','C08', 'Acquired Brain Injury Service'),
 ('SERVICE_TEAM','C09', 'Community Eating-Disorder Service for Children and Young People'), 
 ('SERVICE_TEAM','D01', 'Substance Misuse Team'),
 ('SERVICE_TEAM','D02', 'Criminal Justice Liaison and Diversion Service'),
 ('SERVICE_TEAM','D03', 'Prison Psychiatric Inreach Service'),
 ('SERVICE_TEAM','D04', 'Asylum Service'),
 ('SERVICE_TEAM','D05', 'Individual Placement and Support Service'),
 ('SERVICE_TEAM','E01', 'Community Team for Learning Disabilities'),
 ('SERVICE_TEAM','E02', 'Epilepsy/Neurological Service'),
 ('SERVICE_TEAM','E03', 'Specialist Parenting Service'),
 ('SERVICE_TEAM','E04', 'Enhanced/Intensive Support Service'),
 ('SERVICE_TEAM','Z01', 'Other Mental Health Service - in scope of National Tariff Payment System'),
 ('SERVICE_TEAM','Z02', 'Other Mental Health Service - out of scope of National Tariff Payment System'),
 ('SERVICE_TEAM','Unknown', 'Unknown'),
 
 -- RESTRAINT --
 ('RESTRAINT','01', 'Physical restraint - Prone'),
 ('RESTRAINT','07', 'Physical restraint - Standing'),
 ('RESTRAINT','08', 'Physical restraint - Restrictive escort'),
 ('RESTRAINT','09', 'Physical restraint - Supine'),
 ('RESTRAINT','10', 'Physical restraint - Side'),
 ('RESTRAINT','11', 'Physical restraint - Seated'),
 ('RESTRAINT','12', 'Physical restraint - Kneeling'),
 ('RESTRAINT','13', 'Physical restraint - Other (not listed)'),
 ('RESTRAINT','14', 'Chemical restraint - Injection (Rapid Tranquillisation)'),
 ('RESTRAINT','15', 'Chemical restraint - Injection (Non Rapid Tranquillisation)'),
 ('RESTRAINT','16', 'Chemical restraint - Oral'),
 ('RESTRAINT','17', 'Chemical restraint - Other (not listed)'),
 ('RESTRAINT','04', 'Mechanical restraint'),
 ('RESTRAINT','05', 'Seclusion'),
 ('RESTRAINT','06', 'Segregation'),
 ('RESTRAINT','Unknown', 'Unknown'),
 
 -- IMD Decile--
 ('IMD','10 Least deprived', '10 Least deprived'),
 ('IMD','09 Less deprived', '09 Less deprived'),
 ('IMD','08 Less deprived', '08 Less deprived'),
 ('IMD','07 Less deprived', '07 Less deprived'),
 ('IMD','06 Less deprived', '06 Less deprived'),
 ('IMD','05 More deprived', '05 More deprived'),
 ('IMD','04 More deprived', '04 More deprived'),
 ('IMD','03 More deprived', '03 More deprived'),
 ('IMD','02 More deprived', '02 More deprived'),
 ('IMD','01 Most deprived', '01 Most deprived'),
 ('IMD','Unknown', 'Unknown'),
 
 -- IMD Quintile--
 ('IMD_QUIN','05 Least deprived', '05 Least deprived'),
 ('IMD_QUIN','04', '04'),
 ('IMD_QUIN','03', '03'),
 ('IMD_QUIN','02', '02'),
 ('IMD_QUIN','01 Most deprived', '01 Most deprived'),
 ('IMD_QUIN','Unknown', 'Unknown'),
 
 -- CONTACTS_AGE_GROUP --
 ('CONTACTS_AGE_GROUP','0 to 5', '0 to 5'),
 ('CONTACTS_AGE_GROUP','6 to 10', '6 to 10'),
 ('CONTACTS_AGE_GROUP','11 to 15', '11 to 15'),
 ('CONTACTS_AGE_GROUP','16', '16'),
 ('CONTACTS_AGE_GROUP','17', '17'),
 ('CONTACTS_AGE_GROUP','18', '18'),
 ('CONTACTS_AGE_GROUP','Unknown', 'Unknown'),
 
 -- MEMORY_AGE_GROUP --
 ('MEMORY_AGE_GROUP','Under 18', 'Under 18'),
 ('MEMORY_AGE_GROUP','18 to 19', '18 to 19'),
 ('MEMORY_AGE_GROUP','20 to 24', '20 to 24'),
 ('MEMORY_AGE_GROUP','25 to 29', '25 to 29'),
 ('MEMORY_AGE_GROUP','30 to 34', '30 to 34'),
 ('MEMORY_AGE_GROUP','35 to 39', '35 to 39'),
 ('MEMORY_AGE_GROUP','40 to 44', '40 to 44'),
 ('MEMORY_AGE_GROUP','45 to 49', '45 to 49'),
 ('MEMORY_AGE_GROUP','50 to 54', '50 to 54'),
 ('MEMORY_AGE_GROUP','55 to 59', '55 to 59'),
 ('MEMORY_AGE_GROUP','60 to 64', '60 to 64'),
 ('MEMORY_AGE_GROUP','65 to 69', '65 to 69'),
 ('MEMORY_AGE_GROUP','70 to 74', '70 to 74'),
 ('MEMORY_AGE_GROUP','75 to 79', '75 to 79'),
 ('MEMORY_AGE_GROUP','80 to 84', '80 to 84'),
 ('MEMORY_AGE_GROUP','85 to 89', '85 to 89'),
 ('MEMORY_AGE_GROUP','90 or over', '90 or over'),
 ('MEMORY_AGE_GROUP','Unknown', 'Unknown'),
 
 --- BED_TYPE ---
 ('BED_TYPE', 'CYP Acute', 'CYP Acute'),
 ('BED_TYPE', 'CYP Specialist', 'CYP Specialist'),
 ('BED_TYPE', 'Adult Acute', 'Adult Acute'),
 ('BED_TYPE', 'Adult Specialist', 'Adult Specialist'),
 ('BED_TYPE', 'Older Adult Acute', 'Older Adult Acute'),
 ('BED_TYPE', 'Invalid', 'Invalid'),
 
 ---SERVICE_TYPE---
 ('SERVICE_TYPE', 'Core Community Mental Health', 'Core Community Mental Health'),
 ('SERVICE_TYPE', 'Early Intervention Team for Psychosis', 'Early Intervention Team for Psychosis'),
 ('SERVICE_TYPE', 'Individual Placement and Support', 'Individual Placement and Support'),
 ('SERVICE_TYPE', 'Specialist Perinatal Mental Health', 'Specialist Perinatal Mental Health'),
 ('SERVICE_TYPE', '24/7 Crisis Response Line', '24/7 Crisis Response Line'),
 ('SERVICE_TYPE', 'Crisis and Acute Mental Health Activity in Community Settings', 'Crisis and Acute Mental Health Activity in Community Settings'),
 ('SERVICE_TYPE', 'Mental Health Activity in General Hospitals', 'Mental Health Activity in General Hospitals'),
 ('SERVICE_TYPE', 'LDA', 'LDA'),
 ('SERVICE_TYPE', 'Forensic Services', 'Forensic Services'),
 ('SERVICE_TYPE', 'Autism Service', 'Autism Service'),
 ('SERVICE_TYPE', 'Specialist Services', 'Specialist Services'),
 ('SERVICE_TYPE', 'Other Mental Health Services', 'Other Mental Health Services'),
 ('SERVICE_TYPE', 'Other', 'Other'),
 ('SERVICE_TYPE', 'Unknown', 'Unknown'),
 
 -- AGE_LL_Access --
 ('AGE_LL_Access','18 to 19', '18 to 19'),
 ('AGE_LL_Access','20 to 24', '20 to 24'),
 ('AGE_LL_Access','25 to 29', '25 to 29'),
 ('AGE_LL_Access','30 to 34', '30 to 34'),
 ('AGE_LL_Access','35 to 39', '35 to 39'),
 ('AGE_LL_Access','40 to 44', '40 to 44'),
 ('AGE_LL_Access','45 to 49', '45 to 49'),
 ('AGE_LL_Access','50 to 54', '50 to 54'),
 ('AGE_LL_Access','55 to 59', '55 to 59'),
 ('AGE_LL_Access','60 to 64', '60 to 64'),
 ('AGE_LL_Access','65 to 69', '65 to 69'),
 ('AGE_LL_Access','70 to 74', '70 to 74'),
 ('AGE_LL_Access','75 to 79', '75 to 79'),
 ('AGE_LL_Access','80 to 84', '80 to 84'),
 ('AGE_LL_Access','85 to 89', '85 to 89'),
 ('AGE_LL_Access','90 and over', '90 and over'),
 ('AGE_LL_Access','Unknown', 'Unknown')

# COMMAND ----------

 %sql
 INSERT INTO $db_output.ref_master
 ---add local authority codes and names valid in the financial year
 SELECT		DISTINCT 'LADUA' as type
             ,LADCD as level
             ,LADNM as level_description
 FROM		[DATABASE].[LA_ORG_REF]
 WHERE		DSS_ONS_PUBLISHED_DATE = '$LAD_published_date'
             AND DSS_RECORD_END_DATE IS NULL
             AND LADCD NOT  LIKE 'M%' AND LADCD NOT LIKE  'X%' AND LADCD NOT  in ( 'N%', 'W%', 'S%')

# COMMAND ----------

 %sql
 INSERT INTO $db_output.ref_master
 ---add stp codes and names valid in the financial year
 SELECT DISTINCT 'STP' as type
                 ,STP_Code as level
                 ,STP_Name as level_description
 FROM $db_output.stp_region_mapping

# COMMAND ----------

 %sql
 INSERT INTO $db_output.ref_master
 ---add commissioning region codes and names valid in the financial year
 SELECT DISTINCT 'COMM_REGION' as type
                 ,Region_Code as level
                 ,Region_Name as level_description
 FROM $db_output.stp_region_mapping

# COMMAND ----------

 %sql
 INSERT INTO $db_output.ref_master
 ---add providers codes and names valid in the financial year who submitted to mhs000header in the financial year
 SELECT DISTINCT	'Provider' as type
                 ,HDR.OrgIDProvider as level
 		        ,ORG.NAME as level_description					
 FROM $db_output.MHB_MHS000Header AS HDR
 LEFT OUTER JOIN (
                   SELECT DISTINCT ORG_CODE, 
                                   NAME
                    FROM $db_output.MHB_ORG_DAILY
                   WHERE (BUSINESS_END_DATE >= add_months('$rp_enddate', 1) OR ISNULL(BUSINESS_END_DATE))
                         AND BUSINESS_START_DATE <= add_months('$rp_enddate', 1)	
                         AND ORG_TYPE_CODE NOT IN ('MP', 'IR', 'F', 'GO', 'CN')                 
                 )
 AS ORG
 ON HDR.OrgIDProvider = ORG.ORG_CODE

# COMMAND ----------

 %sql
 INSERT INTO $db_output.ref_master
 ---add ccg codes and names valid in the financial year
 SELECT DISTINCT 'CCG - Registration or Residence' as type
                 ,CCG_Code as level
                 ,CCG_Name as level_description
 FROM $db_output.stp_region_mapping

# COMMAND ----------

 %sql
 ---add team type codes and descriptions into $db_output.TeamType
 INSERT INTO $db_output.TeamType VALUES
 ('A01', 'Day Care Services')
 ,('A02', 'Crisis Resolution Team/Home Treatment')
 ,('A03', 'Adult Community Mental Health Team')
 ,('A04', 'Older People Community Mental Health Team')
 ,('A05', 'Assertive Outreach Team')
 ,('A06', 'Rehabilitation and Recovery Team')
 ,('A07', 'General Psychiatry')
 ,('A08', 'Psychiatric Liaison')
 ,('A09', 'Psychotherapy Service')
 ,('A10', 'Psychological Therapy Service (IAPT)')
 ,('A11', 'Psychological Therapy Service (non-IAPT)')
 ,('A12', 'Young Onset Dementia')
 ,('A13', 'Personality Disorder Service')
 ,('A14', 'Early Intervention in Psychosis Team')
 ,('A15', 'Primary Care Mental Health Services')
 ,('A16', 'Memory Services/Clinic')
 ,('B01', 'Forensic Service')
 ,('B02', 'Community Forensic Service')
 ,('C01', 'Learning Disability Service')
 ,('C02', 'Autistic Spectrum Disorder Service')
 ,('C03', 'Peri-Natal Mental Illness')
 ,('C04', 'Eating Disorders/Dietetics')
 ,('D01', 'Substance Misuse Team')
 ,('D02', 'Criminal Justice Liaison and Diversion Service')
 ,('D03', 'Prison Psychiatric Inreach Service')
 ,('D04', 'Asylum Service')
 ,('E01', 'Community Team for Learning Disabilities')
 ,('E02', 'Epilepsy/Neurological Service')
 ,('E03', 'Specialist Parenting Service')
 ,('E04', 'Enhanced/Intensive Support Service')
 ,('Z01', 'Other Mental Health Service - in scope of National Tariff Payment System')
 ,('Z02', 'Other Mental Health Service - out of scope of National Tariff Payment System')
 ,('ZZZ', 'Other Mental Health Service')

# COMMAND ----------

# DBTITLE 0,I
 %sql
 INSERT INTO TABLE $db_output.measure_level_type_mapping VALUES
 ---insert all breakdowns associated with each mh bulletin metric
 -- Chapter 1 --
 ('1a', 'England', 'England', Null, Null),
 ('1b', 'England', 'England', Null, Null),
 ('1c', 'England', 'England', Null, Null),
 ('1d', 'England', 'England', Null, Null),
 ('1e', 'England', 'England', Null, Null),
 ('1f', 'England', 'England', Null, Null),
 ('1g', 'England', 'England', Null, Null),
 ('1h', 'England', 'England', Null, Null),
 ('1i', 'England', 'England', Null, Null),
 ('1m', 'England', 'England', Null, Null),
 ('1a', 'Commissioning Region', 'COMM_REGION', Null, Null), 
 ('1b', 'Commissioning Region', 'COMM_REGION', Null, Null), 
 ('1c', 'Commissioning Region', 'COMM_REGION', Null, Null), 
 ('1d', 'Commissioning Region', 'COMM_REGION', Null, Null), 
 ('1a', "Commissioning Region; Age Group (Higher Level)", 'COMM_REGION', 'AGE_HL', Null), 
 ('1b', "Commissioning Region; Age Group (Higher Level)", 'COMM_REGION', 'AGE_HL', Null), 
 ('1c', "Commissioning Region; Age Group (Higher Level)", 'COMM_REGION', 'AGE_HL', Null), 
 ('1d', "Commissioning Region; Age Group (Higher Level)", 'COMM_REGION', 'AGE_HL', Null), 
 ('1a', 'LAD/UA', 'LADUA', Null, Null), 
 ('1a', "LAD/UA; Age Group (Higher Level)", 'LADUA', 'AGE_HL', Null),
 ('1b', 'LAD/UA', 'LADUA', Null, Null),
 ('1b', "LAD/UA; Age Group (Higher Level)", 'LADUA', 'AGE_HL', Null), 
 ('1c', 'LAD/UA', 'LADUA', Null, Null), 
 ('1c', "LAD/UA; Age Group (Higher Level)", 'LADUA', 'AGE_HL', Null), 
 ('1d', 'LAD/UA', 'LADUA', Null, Null), 
 ('1d', "LAD/UA; Age Group (Higher Level)", 'LADUA', 'AGE_HL', Null), 
 ('1a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('1a', "Age Group (Higher Level); Provider Type", 'AGE_HL', 'PROVIDER_TYPE', Null), 
 ('1b', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('1b', "Age Group (Higher Level); Provider Type", 'AGE_HL', 'PROVIDER_TYPE', Null), 
 ('1c', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('1c', "Age Group (Higher Level); Provider Type", 'AGE_HL', 'PROVIDER_TYPE', Null), 
 ('1d', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('1d', "Age Group (Higher Level); Provider Type", 'AGE_HL', 'PROVIDER_TYPE', Null),
 ('1e', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), ---AT Added breakdown 3/11/2021
 ('1a', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('1b', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('1b', "Age Group (Lower Level); Provider Type", 'AGE_LL_T1', 'PROVIDER_TYPE', Null),
 ('1c', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('1c', "Age Group (Lower Level); Provider Type", 'AGE_LL_T1', 'PROVIDER_TYPE', Null),
 ('1d', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('1e', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('1f', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('1g', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null), 
 
 ('1a', 'Gender', 'GENDER', Null, Null),
 ('1a', "Gender; Provider Type", 'GENDER', 'PROVIDER_TYPE', Null), 
 ('1a', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null),
 ('1b', 'Gender', 'GENDER', Null, Null),
 ('1b', "Gender; Provider Type", 'GENDER', 'PROVIDER_TYPE', Null),
 ('1b', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null),
 ('1b', "Gender; Age Group (Lower Level); Provider Type", 'GENDER', 'AGE_LL_T1', 'PROVIDER_TYPE'),
 ('1c', 'Gender', 'GENDER', Null, Null),
 ('1c', "Gender; Provider Type", 'GENDER', 'PROVIDER_TYPE', Null), 
 ('1c', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null),
 ('1c', "Gender; Age Group (Lower Level); Provider Type", 'GENDER', 'AGE_LL_T1', 'PROVIDER_TYPE'),
 ('1d', 'Gender', 'GENDER', Null, Null),
 ('1d', "Gender; Provider Type", 'GENDER', 'PROVIDER_TYPE', Null),
 ('1d', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null),
 ('1e', 'Gender', 'GENDER', Null, Null),
 ('1e', "Gender; Provider Type", 'GENDER', 'PROVIDER_TYPE', Null),
 ('1e', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null),
 ('1f', 'Gender', 'GENDER', Null, Null),
 ('1f', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null),
 ('1g', 'Gender', 'GENDER', Null, Null),
 ('1g', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_T1', Null), 
 ('1a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('1m', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('1h', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('1i', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('1k', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('1j', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('1a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('1m', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('1h', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('1i', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('1j', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('1k', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('1a', 'IMD', 'IMD', Null, Null),
 ('1a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), ---Added in 23/09/21 AT
 ('1a', "IMD; Gender; Age Group (Lower Level)", 'IMD', 'GENDER', 'AGE_LL_T1'),
 ('1a', "IMD; Ethnicity (Higher Level)", 'IMD', 'ETHNIC_HL', Null),
 ('1a', 'STP', 'STP', Null, Null),
 ('1a', "STP; Age Group (Higher Level)", 'STP', 'AGE_HL', Null),
 ('1b', 'STP', 'STP', Null, Null),
 ('1b', "STP; Age Group (Higher Level)", 'STP', 'AGE_HL', Null),
 ('1c', 'STP', 'STP', Null, Null),
 ('1c', "STP; Age Group (Higher Level)", 'STP', 'AGE_HL', Null),
 ('1d', 'STP', 'STP', Null, Null),
 ('1d', "STP; Age Group (Higher Level)", 'STP', 'AGE_HL', Null),
 
 ('1a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('1a', "CCG - Registration or Residence; Age Group (Higher Level)", 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('1a', "CCG - Registration or Residence; Gender; Age Group (Lower Level)", 'CCG - Registration or Residence', 'GENDER', 'AGE_LL_T1'),
 ('1b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('1b', "CCG - Registration or Residence; Age Group (Higher Level)", 'CCG - Registration or Residence', 'AGE_HL', Null), 
 ('1c', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('1c', "CCG - Registration or Residence; Age Group (Higher Level)", 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('1d', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('1d', "CCG - Registration or Residence; Age Group (Higher Level)", 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('1a', 'Provider Type', 'PROVIDER_TYPE', Null, Null),
 ('1b', 'Provider Type', 'PROVIDER_TYPE', Null, Null),
 ('1c', 'Provider Type', 'PROVIDER_TYPE', Null, Null),
 ('1d', 'Provider Type', 'PROVIDER_TYPE', Null, Null),
 ('1e', 'Provider Type', 'PROVIDER_TYPE', Null, Null),
 ('1a', 'Provider', 'Provider', Null, Null),
 ('1a', "Provider; Age Group (Higher Level)", 'Provider', 'AGE_HL', Null), 
 ('1b', 'Provider', 'Provider', Null, Null),
 ('1b', "Provider; Age Group (Higher Level)", 'Provider', 'AGE_HL', Null), 
 ('1c', 'Provider', 'Provider', Null, Null),
 ('1c', "Provider; Age Group (Higher Level)", 'Provider', 'AGE_HL', Null),
 ('1d', 'Provider', 'Provider', Null, Null),
 ('1d', "Provider; Age Group (Higher Level)", 'Provider', 'AGE_HL', Null), 
 ('1a', "CCG - Registration or Residence; IMD", 'CCG - Registration or Residence', 'IMD', Null), 
 ('1a', "CCG - Registration or Residence; Ethnicity (Higher Level)", 'CCG - Registration or Residence', 'ETHNIC_HL', Null), 
 
 -- Chapter 4 --
 ('4a', 'England', 'England', Null, Null),
 ('4a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('4a', 'LAD/UA', 'LADUA', Null, Null),
 
 ('4a', 'Age Group (Lower Level)', 'AGE_LL', Null, Null),
 ('4a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), ---Added in 28/09/21 AT
 ('4a', "Age Group (Lower Level); Provider Type", 'AGE_LL', 'PROVIDER_TYPE', Null),
 ('4a', 'Gender', 'GENDER', Null, Null),
 ('4a', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL', Null),
 ('4a', "Gender; Age Group (Lower Level); Provider Type", 'GENDER', 'AGE_LL', 'PROVIDER_TYPE'),
 ('4a', "Gender; Provider Type", 'GENDER', 'PROVIDER_TYPE', Null),
 ('4a', 'STP', 'STP', Null, Null),
 ('4a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('4a', 'Provider', 'Provider', Null, Null),
 ('4a', 'Provider Type', 'PROVIDER_TYPE', Null, Null), 
 
 -- Chapter 5 --
 ('5a', 'England', 'England', Null, Null),
 ('5b', 'England', 'England', Null, Null),
 ('5c', 'England', 'England', Null, Null),
 ('5a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('5b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('5c', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('5a', 'LAD/UA', 'LADUA', Null, Null),
 ('5b', 'LAD/UA', 'LADUA', Null, Null),
 ('5c', 'LAD/UA', 'LADUA', Null, Null),
 ('5a', 'Age Group (Lower Level)', 'AGE_LL', Null, Null),
 ('5b', 'Age Group (Lower Level)', 'AGE_LL', Null, Null),
 ('5a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), ---Added in 28/09/21 AT
 ('5b', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), ---Added in 28/09/21 AT
 ('5a', 'Gender', 'GENDER', Null, Null),
 ('5a', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL', Null),
 ('5b', 'Gender', 'GENDER', Null, Null),
 ('5b', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL', Null),
 ('5a', 'STP', 'STP', Null, Null),
 ('5b', 'STP', 'STP', Null, Null),
 ('5c', 'STP', 'STP', Null, Null),
 ('5a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('5b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('5c', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('5a', 'Provider', 'Provider', Null, Null),
 ('5b', 'Provider', 'Provider', Null, Null),
 ('5c', 'Provider', 'Provider', Null, Null),
 
 -- Chapter 6 --
 ('6a', 'England', 'England', Null, Null),
 ('6b', 'England', 'England', Null, Null),
 ('6c', 'England', 'England', Null, Null),
 ('6d', 'England', 'England', Null, Null),
 ('6e', 'England', 'England', Null, Null),
 ('6a', 'Attendance Code', 'ATTENDANCE', Null, Null),
 ('6a', "Attendance Code; Service or Team Type", 'ATTENDANCE', 'SERVICE_TEAM', Null),
 ('6a', 'Service or Team Type', 'SERVICE_TEAM', Null, Null),
 ('6b', 'Service or Team Type', 'SERVICE_TEAM', Null, Null),
 ('6c', 'Service or Team Type', 'SERVICE_TEAM', Null, Null),
 ('6d', 'Service or Team Type', 'SERVICE_TEAM', Null, Null),
 ('6e', 'Service or Team Type', 'SERVICE_TEAM', Null, Null),
 ('6a', "Provider; Service or Team Type", 'Provider', 'SERVICE_TEAM', Null),
 ('6a', 'Provider', 'Provider', Null, Null),
 ('6b', "Provider; Service or Team Type", 'Provider', 'SERVICE_TEAM', Null),
 ('6b', 'Provider', 'Provider', Null, Null),
 
 --Chapter 7 --
 ('7a', 'England', 'England', Null, Null),
 ('7b', 'England', 'England', Null, Null),
 ('7c', 'England', 'England', Null, Null),
 ('7d', 'England', 'England', Null, Null),
 ('7a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('7a', "Commissioning Region; Intervention Type", 'COMM_REGION', 'RESTRAINT', Null),
 ('7b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('7b', "Commissioning Region; Intervention Type", 'COMM_REGION', 'RESTRAINT', Null),
 ('7a', 'LAD/UA', 'LADUA', Null, Null),
 ('7a', "LAD/UA; Intervention Type", 'LADUA', 'RESTRAINT', Null),
 ('7b', 'LAD/UA', 'LADUA', Null, Null),
 ('7b', "LAD/UA; Intervention Type", 'LADUA', 'RESTRAINT', Null),
 ('7a', 'Age Group (Lower Level)', 'AGE_LL_restraint', Null, Null),
 ('7b', 'Age Group (Lower Level)', 'AGE_LL_restraint', Null, Null),
 ('7a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), ---Added in 28/09/21 AT
 ('7b', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), ---Added in 28/09/21 AT
 ('7a', 'Gender', 'GENDER', Null, Null),
 ('7a', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_restraint', Null),
 ('7b', 'Gender', 'GENDER', Null, Null),
 ('7b', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_restraint', Null),
 ('7a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('7c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('7b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('7d', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('7e', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('7f', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('7a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('7b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('7c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('7d', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('7e', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('7f', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('7a', 'Intervention Type', 'RESTRAINT', Null, Null),
 ('7a', "Intervention Type; Gender", 'RESTRAINT', 'GENDER', Null),
 ('7a', "Intervention Type; Age Group (Lower Level)", 'RESTRAINT', 'AGE_LL_restraint', Null),
 ('7a', "Intervention Type; Gender; Age Group (Lower Level)", 'RESTRAINT', 'GENDER', 'AGE_LL_restraint'),
 ('7b', 'Intervention Type', 'RESTRAINT', Null, Null),
 ('7b', "Intervention Type; Gender", 'RESTRAINT', 'GENDER', Null),
 ('7b', "Intervention Type; Age Group (Lower Level)", 'RESTRAINT', 'AGE_LL_restraint', Null),
 ('7b', "Intervention Type; Gender; Age Group (Lower Level)", 'RESTRAINT', 'GENDER', 'AGE_LL_restraint'),
 ('7a', 'STP', 'STP', Null, Null),
 ('7a', "STP; Intervention Type", 'STP', 'RESTRAINT', Null),
 ('7b', 'STP', 'STP', Null, Null),
 ('7b', "STP; Intervention Type", 'STP', 'RESTRAINT', Null),
 ('7a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('7a', "CCG - Registration or Residence; Intervention Type", 'CCG - Registration or Residence', 'RESTRAINT', Null),
 ('7b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('7b', "CCG - Registration or Residence; Intervention Type", 'CCG - Registration or Residence', 'RESTRAINT', Null),
 ('7a', 'Provider', 'Provider', Null, Null),
 ('7a', "Provider; Intervention Type", 'Provider', 'RESTRAINT', Null),
 ('7b', 'Provider', 'Provider', Null, Null),
 ('7b', "Provider; Intervention Type", 'Provider', 'RESTRAINT', Null),
 
 -- Chapter 9 --
 ('9a', 'England', 'England', Null, Null),
 ('9a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('9a', 'LAD/UA', 'LADUA', Null, Null),
 ('9a', 'Gender', 'GENDER', Null, Null),
 ('9a', "Gender; Age Group (Lower Level)", 'GENDER', 'CONTACTS_AGE_GROUP', Null),
 ('9a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('9a', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'CONTACTS_AGE_GROUP', Null),
 ('9a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('9a', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'CONTACTS_AGE_GROUP', Null),
 ('9a', 'IMD', 'IMD', Null, Null),
 ('9a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), ---Added in 28/09/21 AT
 ('9a', 'Age Group (Lower Level)', 'CONTACTS_AGE_GROUP', Null, Null),
 ('9a', 'STP', 'STP', Null, Null),
 ('9a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('9a', 'Provider', 'Provider', Null, Null),
 ('9a', "IMD; Age Group (Lower Level)", 'IMD', 'CONTACTS_AGE_GROUP', Null), 
 --RATES
 ('9b', 'England', 'England', Null, Null),
 ('9b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('9b', 'STP', 'STP', Null, Null),
 ('9b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('9b', 'Age Group (Lower Level)', 'CONTACTS_AGE_GROUP', Null, Null),
 ('9b', 'Gender', 'GENDER', Null, Null),
 ('9b', "Gender; Age Group (Lower Level)", 'GENDER', 'CONTACTS_AGE_GROUP', Null),
 ('9b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('9b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('9b', 'IMD', 'IMD', Null, Null),
 
 -- Chapter 10 --
 ('10a', 'England', 'England', Null, Null),
 ('10b', 'England', 'England', Null, Null),
 ('10c', 'England', 'England', Null, Null),
 ('10d', 'England', 'England', Null, Null),
 ('10e', 'England', 'England', Null, Null),
 ('10f', 'England', 'England', Null, Null),
 ('10a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10c', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10d', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10e', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10f', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10a', 'LAD/UA', 'LADUA', Null, Null),
 ('10b', 'LAD/UA', 'LADUA', Null, Null),
 ('10c', 'LAD/UA', 'LADUA', Null, Null),
 ('10d', 'LAD/UA', 'LADUA', Null, Null),
 ('10e', 'LAD/UA', 'LADUA', Null, Null),
 ('10f', 'LAD/UA', 'LADUA', Null, Null),
 ('10a', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10b', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10c', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10d', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10e', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10f', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null),
 ('10b', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('10c', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('10d', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('10e', 'Age Group (Higher Level)', 'AGE_HL', Null, Null),
 ('10f', 'Age Group (Higher Level)', 'AGE_HL', Null, Null),
 ('10a', 'Gender', 'GENDER', Null, Null),
 ('10b', 'Gender', 'GENDER', Null, Null),
 ('10c', 'Gender', 'GENDER', Null, Null),
 ('10d', 'Gender', 'GENDER', Null, Null),
 ('10e', 'Gender', 'GENDER', Null, Null),
 ('10f', 'Gender', 'GENDER', Null, Null),
 ('10a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10d', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10e', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10f', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10a', "Gender; Age Group (Lower Level)", 'GENDER', 'EIP_Age_LL', Null),
 ('10b', "Gender; Age Group (Lower Level)", 'GENDER', 'EIP_Age_LL', Null),
 ('10c', "Gender; Age Group (Lower Level)", 'GENDER', 'EIP_Age_LL', Null),
 ('10d', "Gender; Age Group (Lower Level)", 'GENDER', 'EIP_Age_LL', Null),
 ('10e', "Gender; Age Group (Lower Level)", 'GENDER', 'EIP_Age_LL', Null),
 ('10f', "Gender; Age Group (Lower Level)", 'GENDER', 'EIP_Age_LL', Null),
 ('10a', "Ethnicity (Higher Level); Age Group (Lower Level)" , 'ETHNIC_HL', 'EIP_Age_LL', Null),
 ('10b', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'EIP_Age_LL', Null),
 ('10c', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'EIP_Age_LL', Null),
 ('10d', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'EIP_Age_LL', Null),
 ('10e', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'EIP_Age_LL', Null),
 ('10f', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'EIP_Age_LL', Null),
 ('10a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10d', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10e', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10f', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10a', "Ethnicity (Lower Level); Age Group (Lower Level)" , 'ETHNIC_LL', 'EIP_Age_LL', Null),
 ('10b', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'EIP_Age_LL', Null),
 ('10c', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'EIP_Age_LL', Null),
 ('10d', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'EIP_Age_LL', Null),
 ('10e', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'EIP_Age_LL', Null),
 ('10f', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'EIP_Age_LL', Null),
 ('10a', 'IMD', 'IMD', Null, Null),
 ('10b', 'IMD', 'IMD', Null, Null),
 ('10c', 'IMD', 'IMD', Null, Null),
 ('10d', 'IMD', 'IMD', Null, Null),
 ('10e', 'IMD', 'IMD', Null, Null),
 ('10f', 'IMD', 'IMD', Null, Null),
 ('10a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('10b', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('10c', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('10d', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('10e', 'IMD Quintiles', 'IMD_QUIN', Null, Null),
 ('10f', 'IMD Quintiles', 'IMD_QUIN', Null, Null),
 ('10a', "IMD; Age Group (Lower Level)", 'IMD', 'EIP_Age_LL', Null),
 ('10b', "IMD; Age Group (Lower Level)", 'IMD', 'EIP_Age_LL', Null),
 ('10c', "IMD; Age Group (Lower Level)", 'IMD', 'EIP_Age_LL', Null),
 ('10d', "IMD; Age Group (Lower Level)", 'IMD', 'EIP_Age_LL', Null),
 ('10e', "IMD; Age Group (Lower Level)", 'IMD', 'EIP_Age_LL', Null),
 ('10f', "IMD; Age Group (Lower Level)", 'IMD', 'EIP_Age_LL', Null),
 ('10a', 'STP', 'STP', Null, Null),
 ('10b', 'STP', 'STP', Null, Null),
 ('10c', 'STP', 'STP', Null, Null),
 ('10d', 'STP', 'STP', Null, Null),
 ('10e', 'STP', 'STP', Null, Null),
 ('10f', 'STP', 'STP', Null, Null),
 ('10a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10c', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10d', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10e', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10f', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10a', 'Provider', 'Provider', Null, Null),
 ('10b', 'Provider', 'Provider', Null, Null),
 ('10c', 'Provider', 'Provider', Null, Null),
 ('10d', 'Provider', 'Provider', Null, Null),
 ('10e', 'Provider', 'Provider', Null, Null),
 ('10f', 'Provider', 'Provider', Null, Null),
 --Rates
 ('10g', 'England', 'England', Null, Null),
 ('10g', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10g', 'Gender', 'GENDER', Null, Null),
 ('10g', 'Gender; Age Group (Lower Level)', 'GENDER', 'EIP_Age_LL', Null),
 ('10g', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10g', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10g', 'IMD', 'IMD', Null, Null),
 ('10g', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10g', 'STP', 'STP', Null, Null),
 ('10g', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10g', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10g', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10h', 'England', 'England', Null, Null),
 ('10h', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10h', 'Gender', 'GENDER', Null, Null),
 ('10h', 'Gender; Age Group (Lower Level)', 'GENDER', 'EIP_Age_LL', Null),
 ('10h', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10h', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10h', 'IMD', 'IMD', Null, Null),
 ('10h', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10h', 'STP', 'STP', Null, Null),
 ('10h', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10h', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10h', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10i', 'England', 'England', Null, Null),
 ('10i', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10i', 'Gender', 'GENDER', Null, Null),
 ('10i', 'Gender; Age Group (Lower Level)', 'GENDER', 'EIP_Age_LL', Null),
 ('10i', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10i', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10i', 'IMD', 'IMD', Null, Null),
 ('10i', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10i', 'STP', 'STP', Null, Null),
 ('10i', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10i', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10i', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10j', 'England', 'England', Null, Null),
 ('10j', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10j', 'Gender', 'GENDER', Null, Null),
 ('10j', 'Gender; Age Group (Lower Level)', 'GENDER', 'EIP_Age_LL', Null),
 ('10j', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10j', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10j', 'IMD', 'IMD', Null, Null),
 ('10j', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10j', 'STP', 'STP', Null, Null),
 ('10j', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10j', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10j', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10k', 'England', 'England', Null, Null),
 ('10k', 'Age Group (Lower Level)', 'EIP_Age_LL', Null, Null),
 ('10k', 'Gender', 'GENDER', Null, Null),
 ('10k', 'Gender; Age Group (Lower Level)', 'GENDER', 'EIP_Age_LL', Null),
 ('10k', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('10k', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('10k', 'IMD', 'IMD', Null, Null),
 ('10k', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('10k', 'STP', 'STP', Null, Null),
 ('10k', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('10k', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10k', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 
 -- Chapter 13 --
 ('13a', 'England', 'England', Null, Null),
 ('13b', 'England', 'England', Null, Null),
 ('13c', 'England', 'England', Null, Null),
 ('13a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('13b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('13c', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('13a', 'LAD/UA', 'LADUA', Null, Null),
 ('13b', 'LAD/UA', 'LADUA', Null, Null),
 ('13c', 'LAD/UA', 'LADUA', Null, Null),-----
 ('13a', 'Age Group (Lower Level)', 'MEMORY_AGE_GROUP', Null, Null),
 ('13b', 'Age Group (Lower Level)', 'MEMORY_AGE_GROUP', Null, Null),
 ('13c', 'Age Group (Lower Level)', 'MEMORY_AGE_GROUP', Null, Null),
 ('13a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('13b', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('13c', 'Age Group (Higher Level)', 'AGE_HL', Null, Null),
 ('13a', 'Gender', 'GENDER', Null, Null),
 ('13b', 'Gender', 'GENDER', Null, Null),
 ('13c', 'Gender', 'GENDER', Null, Null),
 ('13a', "Gender; Age Group (Lower Level)", 'GENDER', 'MEMORY_AGE_GROUP', Null),
 ('13b', "Gender; Age Group (Lower Level)", 'GENDER', 'MEMORY_AGE_GROUP', Null),
 ('13c', "Gender; Age Group (Lower Level)", 'GENDER', 'MEMORY_AGE_GROUP', Null),
 ('13a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('13b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('13c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('13a', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'MEMORY_AGE_GROUP', Null),
 ('13b', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'MEMORY_AGE_GROUP', Null),
 ('13c', "Ethnicity (Higher Level); Age Group (Lower Level)", 'ETHNIC_HL', 'MEMORY_AGE_GROUP', Null),
 ('13a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('13b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('13c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('13a', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'MEMORY_AGE_GROUP', Null),
 ('13b', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'MEMORY_AGE_GROUP', Null),
 ('13c', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'MEMORY_AGE_GROUP', Null),
 ('13a', 'IMD', 'IMD', Null, Null),
 ('13b', 'IMD', 'IMD', Null, Null),
 ('13c', 'IMD', 'IMD', Null, Null),
 ('13a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('13b', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('13c', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('13a', "IMD; Age Group (Lower Level)", 'IMD', 'MEMORY_AGE_GROUP', Null),
 ('13b', "IMD; Age Group (Lower Level)", 'IMD', 'MEMORY_AGE_GROUP', Null),
 ('13c', "IMD; Age Group (Lower Level)", 'IMD', 'MEMORY_AGE_GROUP', Null),
 ('13a', 'STP', 'STP', Null, Null),
 ('13b', 'STP', 'STP', Null, Null),
 ('13c', 'STP', 'STP', Null, Null),
 ('13a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('13b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('13c', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('13a', 'Provider', 'Provider', Null, Null),
 ('13b', 'Provider', 'Provider', Null, Null),
 ('13c', 'Provider', 'Provider', Null, Null),
 
 -- Chapter 14 Community Access --
 ('14a', 'England', 'England', Null, Null),
 ('14a', 'Provider', 'Provider', Null, Null),
 ('14a', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('14a', 'STP', 'STP', Null, Null),
 ('14a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('14a', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('14a', 'Gender', 'GENDER', Null, Null),
 ('14a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('14a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('14a', 'IMD', 'IMD', Null, Null),
 ('14a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('14a', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('14a', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('14a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('14a', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('14a', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('14a', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('14a', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('14a', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('14a', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('14a', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('14a', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('14a', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('14a', 'STP; Gender', 'STP', 'GENDER', Null),
 ('14a', 'STP; IMD', 'STP', 'IMD', Null),
 ('14a', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('14a', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('14a', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('14a', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('14a', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 --Crude Rates
 ('14b', 'England', 'England', Null, Null),
 ('14b', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('14b', 'Gender', 'GENDER', Null, Null),
 ('14b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('14b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('14b', 'IMD', 'IMD', Null, Null),
 ('14b', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('14b', 'STP', 'STP', Null, Null),
 ('14b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('14b', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('14b', 'STP; Gender', 'STP', 'GENDER', Null),
 ('14b', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('14b', 'STP; IMD', 'STP', 'IMD', Null),
 
 -- Chapter 15 Community Admissions with and without contact --
 ('15a', 'England', 'England', Null, Null),
 ('15a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('15a', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('15a', 'Gender', 'GENDER', Null, Null),
 ('15a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('15a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('15a', 'IMD', 'IMD', Null, Null),
 ('15a', 'STP', 'STP', Null, Null),
 ('15a', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('15a', 'Provider', 'Provider', Null, Null),
 ('15a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('15a', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('15a', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('15a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('15a', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('15a', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('15a', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('15a', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('15a', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('15a', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('15a', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('15a', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('15a', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('15a', 'STP; Gender', 'STP', 'GENDER', Null),
 ('15a', 'STP; IMD', 'STP', 'IMD', Null),
 ('15a', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('15a', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('15a', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('15a', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('15a', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('15b', 'England', 'England', Null, Null),
 ('15b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('15b', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('15b', 'Gender', 'GENDER', Null, Null),
 ('15b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('15b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('15b', 'IMD', 'IMD', Null, Null),
 ('15b', 'STP', 'STP', Null, Null),
 ('15b', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('15b', 'Provider', 'Provider', Null, Null),
 ('15b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('15b', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('15b', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('15b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('15b', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('15b', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('15b', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('15b', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('15b', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('15b', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('15b', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('15b', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('15b', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('15b', 'STP; Gender', 'STP', 'GENDER', Null),
 ('15b', 'STP; IMD', 'STP', 'IMD', Null),
 ('15b', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('15b', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('15b', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('15b', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('15b', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('15c', 'England', 'England', Null, Null),
 ('15c', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('15c', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('15c', 'Gender', 'GENDER', Null, Null),
 ('15c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('15c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('15c', 'IMD', 'IMD', Null, Null),
 ('15c', 'STP', 'STP', Null, Null),
 ('15c', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('15c', 'Provider', 'Provider', Null, Null),
 ('15c', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('15c', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('15c', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('15c', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('15c', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('15c', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('15c', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('15c', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('15c', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('15c', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('15c', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('15c', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('15c', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('15c', 'STP; Gender', 'STP', 'GENDER', Null),
 ('15c', 'STP; IMD', 'STP', 'IMD', Null),
 ('15c', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('15c', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('15c', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('15c', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('15c', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('15d', 'England', 'England', Null, Null),
 ('15d', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('15d', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('15d', 'Gender', 'GENDER', Null, Null),
 ('15d', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('15d', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('15d', 'IMD', 'IMD', Null, Null),
 ('15d', 'STP', 'STP', Null, Null),
 ('15d', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('15d', 'Provider', 'Provider', Null, Null),
 ('15d', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('15d', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('15d', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('15d', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('15d', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('15d', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('15d', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('15d', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('15d', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('15d', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('15d', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('15d', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('15d', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('15d', 'STP; Gender', 'STP', 'GENDER', Null),
 ('15d', 'STP; IMD', 'STP', 'IMD', Null),
 ('15d', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('15d', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('15d', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('15d', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('15d', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('15e', 'England', 'England', Null, Null),
 ('15e', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('15e', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('15e', 'Gender', 'GENDER', Null, Null),
 ('15e', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('15e', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('15e', 'IMD', 'IMD', Null, Null),
 ('15e', 'STP', 'STP', Null, Null),
 ('15e', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('15e', 'Provider', 'Provider', Null, Null),
 ('15e', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('15e', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('15e', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('15e', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('15e', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('15e', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('15e', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('15e', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('15e', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('15e', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('15e', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('15e', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('15e', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('15e', 'STP; Gender', 'STP', 'GENDER', Null),
 ('15e', 'STP; IMD', 'STP', 'IMD', Null),
 ('15e', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('15e', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('15e', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('15e', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('15e', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 
 -- Chapter 16 Length of Stay --
 ('16a', 'England', 'England', Null, Null),
 ('16a', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16a', 'Gender', 'GENDER', Null, Null),
 ('16a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16a', 'IMD', 'IMD', Null, Null),
 ('16a', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16a', 'Provider', 'Provider', Null, Null),
 ('16a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('16a', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('16a', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('16a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('16a', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('16a', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('16a', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('16a', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('16a', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('16a', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('16a', 'STP', 'STP', Null, Null),
 ('16a', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16a', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('16a', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16a', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16a', 'STP; IMD', 'STP', 'IMD', Null),
 ('16a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16a', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('16a', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('16a', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('16a', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('16a', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('16b', 'England', 'England', Null, Null),
 ('16b', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16b', 'Gender', 'GENDER', Null, Null),
 ('16b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16b', 'IMD', 'IMD', Null, Null),
 ('16b', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16b', 'Provider', 'Provider', Null, Null),
 ('16b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('16b', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('16b', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('16b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('16b', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('16b', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('16b', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('16b', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('16b', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('16b', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('16b', 'STP', 'STP', Null, Null),
 ('16b', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16b', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('16b', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16b', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16b', 'STP; IMD', 'STP', 'IMD', Null),
 ('16b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16b', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('16b', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('16b', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('16b', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('16b', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('16c', 'England', 'England', Null, Null),
 ('16c', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16c', 'Gender', 'GENDER', Null, Null),
 ('16c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16c', 'IMD', 'IMD', Null, Null),
 ('16c', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16c', 'Provider', 'Provider', Null, Null),
 ('16c', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('16c', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('16c', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('16c', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('16c', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('16c', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('16c', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('16c', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('16c', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('16c', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('16c', 'STP', 'STP', Null, Null),
 ('16c', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16c', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('16c', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16c', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16c', 'STP; IMD', 'STP', 'IMD', Null),
 ('16c', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16c', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('16c', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('16c', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('16c', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('16c', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('16d', 'England', 'England', Null, Null),
 ('16d', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16d', 'Gender', 'GENDER', Null, Null),
 ('16d', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16d', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16d', 'IMD', 'IMD', Null, Null),
 ('16d', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16d', 'Provider', 'Provider', Null, Null),
 ('16d', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('16d', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('16d', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_cluster', Null),
 ('16d', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('16d', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('16d', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('16d', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('16d', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_cluster', Null),
 ('16d', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('16d', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('16d', 'STP', 'STP', Null, Null),
 ('16d', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16d', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('16d', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16d', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16d', 'STP; IMD', 'STP', 'IMD', Null),
 ('16d', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16d', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('16d', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('16d', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_cluster', Null),
 ('16d', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('16d', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('16e', 'England', 'England', Null, Null),
 ('16e', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('16e', 'Gender', 'GENDER', Null, Null),
 ('16e', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16e', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16e', 'IMD', 'IMD', Null, Null),
 ('16e', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16e', 'Provider', 'Provider', Null, Null),
 ('16e', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('16e', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('16e', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_T1', Null),
 ('16e', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('16e', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('16e', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('16e', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('16e', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_T1', Null),
 ('16e', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('16e', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('16e', 'STP', 'STP', Null, Null),
 ('16e', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16e', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('16e', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_T1', Null),
 ('16e', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16e', 'STP; IMD', 'STP', 'IMD', Null),
 ('16e', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16e', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('16e', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('16e', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_T1', Null),
 ('16e', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('16e', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 ('16f', 'England', 'England', Null, Null),
 ('16f', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('16f', 'Gender', 'GENDER', Null, Null),
 ('16f', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16f', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16f', 'IMD', 'IMD', Null, Null),
 ('16f', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16f', 'Provider', 'Provider', Null, Null),
 ('16f', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('16f', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('16f', 'Provider; Age Group (Lower Level)', 'Provider', 'AGE_LL_T1', Null),
 ('16f', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('16f', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('16f', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('16f', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('16f', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'AGE_LL_T1', Null),
 ('16f', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('16f', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('16f', 'STP', 'STP', Null, Null),
 ('16f', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16f', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('16f', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_T1', Null),
 ('16f', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16f', 'STP; IMD', 'STP', 'IMD', Null),
 ('16f', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16f', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('16f', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('16f', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'AGE_LL_T1', Null),
 ('16f', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('16f', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 --Crude Rates--
 ('16g', 'England', 'England', Null, Null),
 ('16g', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16g', 'Gender', 'GENDER', Null, Null),
 ('16g', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16g', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16g', 'IMD', 'IMD', Null, Null),
 ('16g', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16g', 'STP', 'STP', Null, Null),
 ('16g', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16g', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16g', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16g', 'STP; IMD', 'STP', 'IMD', Null),
 ('16g', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16h', 'England', 'England', Null, Null),
 ('16h', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16h', 'Gender', 'GENDER', Null, Null),
 ('16h', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16h', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16h', 'IMD', 'IMD', Null, Null),
 ('16h', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16h', 'STP', 'STP', Null, Null),
 ('16h', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16h', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16h', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16h', 'STP; IMD', 'STP', 'IMD', Null),
 ('16h', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16i', 'England', 'England', Null, Null),
 ('16i', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16i', 'Gender', 'GENDER', Null, Null),
 ('16i', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16i', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16i', 'IMD', 'IMD', Null, Null),
 ('16i', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16i', 'STP', 'STP', Null, Null),
 ('16i', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16i', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16i', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16i', 'STP; IMD', 'STP', 'IMD', Null),
 ('16i', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16j', 'England', 'England', Null, Null),
 ('16j', 'Age Group (Lower Level)', 'AGE_LL_cluster', Null, Null),
 ('16j', 'Gender', 'GENDER', Null, Null),
 ('16j', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16j', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16j', 'IMD', 'IMD', Null, Null),
 ('16j', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16j', 'STP', 'STP', Null, Null),
 ('16j', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16j', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_cluster', Null),
 ('16j', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16j', 'STP; IMD', 'STP', 'IMD', Null),
 ('16j', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16k', 'England', 'England', Null, Null),
 ('16k', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('16k', 'Gender', 'GENDER', Null, Null),
 ('16k', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16k', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16k', 'IMD', 'IMD', Null, Null),
 ('16k', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16k', 'STP', 'STP', Null, Null),
 ('16k', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16k', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_T1', Null),
 ('16k', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16k', 'STP; IMD', 'STP', 'IMD', Null),
 ('16k', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('16l', 'England', 'England', Null, Null),
 ('16l', 'Age Group (Lower Level)', 'AGE_LL_T1', Null, Null),
 ('16l', 'Gender', 'GENDER', Null, Null),
 ('16l', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('16l', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('16l', 'IMD', 'IMD', Null, Null),
 ('16l', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('16l', 'STP', 'STP', Null, Null),
 ('16l', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('16l', 'STP; Age Group (Lower Level)', 'STP', 'AGE_LL_T1', Null),
 ('16l', 'STP; Gender', 'STP', 'GENDER', Null),
 ('16l', 'STP; IMD', 'STP', 'IMD', Null),
 ('16l', 'Commissioning Region', 'COMM_REGION', Null, Null),
 
 -- Chapter 17 CYP Access --
 ('17a', 'England', 'England', Null, Null),
 ('17a', 'Provider', 'Provider', Null, Null),
 ('17a', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('17a', 'STP', 'STP', Null, Null),
 ('17a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('17a', 'Age Group (Lower Level)', 'CONTACTS_AGE_GROUP', Null, Null),
 ('17a', 'Gender', 'GENDER', Null, Null),
 ('17a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('17a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('17a', 'IMD', 'IMD', Null, Null),
 ('17a', 'Gender; Age Group (Lower Level)', 'GENDER', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'Ethnicity (Lower Level); Age Group (Lower Level)', 'ETHNIC_LL', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'IMD; Age Group (Lower Level)', 'IMD', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('17a', 'Provider; Ethnicity (Lower Level)', 'Provider', 'ETHNIC_LL', Null),
 ('17a', 'Provider; Age Group (Lower Level)', 'Provider', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('17a', 'Provider; IMD', 'Provider', 'IMD', Null),
 ('17a', 'CCG of Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('17a', 'CCG of Residence; Ethnicity (Lower Level)', 'CCG - Registration or Residence', 'ETHNIC_LL', Null),
 ('17a', 'CCG of Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'CCG of Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('17a', 'CCG of Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('17a', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('17a', 'STP; Ethnicity (Lower Level)', 'STP', 'ETHNIC_LL', Null),
 ('17a', 'STP; Age Group (Lower Level)', 'STP', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'STP; Gender', 'STP', 'GENDER', Null),
 ('17a', 'STP; IMD', 'STP', 'IMD', Null),
 ('17a', 'Commissioning Region; Ethnicity (Higher Level)', 'COMM_REGION', 'ETHNIC_HL', Null),
 ('17a', 'Commissioning Region; Ethnicity (Lower Level)', 'COMM_REGION', 'ETHNIC_LL', Null),
 ('17a', 'Commissioning Region; Age Group (Lower Level)', 'COMM_REGION', 'CONTACTS_AGE_GROUP', Null),
 ('17a', 'Commissioning Region; Gender', 'COMM_REGION', 'GENDER', Null),
 ('17a', 'Commissioning Region; IMD', 'COMM_REGION', 'IMD', Null),
 --RATES
 ('17b', 'England', 'England', Null, Null),
 ('17b', 'Age Group (Lower Level)', 'CONTACTS_AGE_GROUP', Null, Null),
 ('17b', 'Gender', 'GENDER', Null, Null),
 ('17b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null),
 ('17b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null),
 ('17b', 'IMD', 'IMD', Null, Null),
 ('17b', 'Gender; Age Group (Lower Level)', 'GENDER', 'CONTACTS_AGE_GROUP', Null),
 ('17b', 'CCG of Residence', 'CCG - Registration or Residence', Null, Null),
 ('17b', 'STP', 'STP', Null, Null),
 ('17b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('17b', 'STP; Age Group (Lower Level)', 'STP', 'CONTACTS_AGE_GROUP', Null),
 ('17b', 'STP; Gender', 'STP', 'GENDER', Null),
 ('17b', 'STP; Ethnicity (Higher Level)', 'STP', 'ETHNIC_HL', Null),
 ('17b', 'STP; IMD', 'STP', 'IMD', Null)

# COMMAND ----------

 %sql
 INSERT INTO TABLE $db_output.measure_level_type_mapping VALUES
 ---additional breakdowns for each metric
 ---Chapter 1---
 ('1a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('1a', 'CCG - Registration or Residence; Service Type Group', 'CCG - Registration or Residence', 'SERVICE_TYPE', Null),
 ('1a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_T1', Null),
 ('1a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('1a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('1a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('1a', 'Provider; Service Type Group', 'Provider', 'SERVICE_TYPE', Null),
 ('1a', 'Service Type as Reported to MHSDS', 'SERVICE_TYPE', Null, Null),
 ('1a', 'Service Type as Reported to MHSDS; Age Group (Higher Level)', 'SERVICE_TYPE', 'AGE_HL', Null),
 ('1a', 'Service Type as Reported to MHSDS; Ethnicity (Higher Level)', 'SERVICE_TYPE', 'ETHNIC_HL', Null),
 ('1a', 'Service Type as Reported to MHSDS; Gender', 'SERVICE_TYPE', 'GENDER', Null),
 ('1a', 'Service Type as Reported to MHSDS; IMD Quintiles', 'SERVICE_TYPE', 'IMD_QUIN', Null),
 
 ('1b', 'Bed Type as Reported to MHSDS', 'BED_TYPE', Null, Null),
 ('1b', 'Bed Type as Reported to MHSDS; Age Group (Higher Level)', 'BED_TYPE', 'AGE_HL', Null),
 ('1b', 'Bed Type as Reported to MHSDS; Ethnicity (Higher Level)', 'BED_TYPE', 'ETHNIC_HL', Null),
 ('1b', 'Bed Type as Reported to MHSDS; IMD Quintiles', 'BED_TYPE', 'IMD_QUIN', Null),
 ('1b', 'Bed Type as Reported to MHSDS; Gender', 'BED_TYPE', 'GENDER', Null),
 ('1b', 'CCG - Registration or Residence; Bed Type Group', 'CCG - Registration or Residence', 'BED_TYPE', Null),
 ('1b', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('1b', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('1b', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('1b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('1b', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_T1', Null),
 ('1b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('1b', 'IMD', 'IMD', Null, Null),
 ('1b', 'IMD Quintiles', 'IMD_QUIN', Null, Null),
 ('1b', 'Provider; Bed Type Group', 'Provider', 'BED_TYPE', Null),
 ('1b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('1b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('1b', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 
 ('1c', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('1c', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('1c', 'CCG - Registration or Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('1c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('1c', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_T1', Null),
 ('1c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('1c', 'IMD', 'IMD', Null, Null),
 ('1c', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('1c', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('1c', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('1c', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('1c', 'CCG - Registration or Residence; Service Type Group', 'CCG - Registration or Residence', 'SERVICE_TYPE', Null),
 ('1c', 'Service Type as Reported to MHSDS', 'SERVICE_TYPE', Null, Null),
 ('1c', 'Service Type as Reported to MHSDS; Age Group (Higher Level)', 'SERVICE_TYPE', 'AGE_HL', Null),
 ('1c', 'Service Type as Reported to MHSDS; Ethnicity (Higher Level)', 'SERVICE_TYPE', 'ETHNIC_HL', Null),
 ('1c', 'Service Type as Reported to MHSDS; Gender', 'SERVICE_TYPE', 'GENDER', Null),
 ('1c', 'Service Type as Reported to MHSDS; IMD Quintiles', 'SERVICE_TYPE', 'IMD_QUIN', Null),
 
 ('1e', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('1e', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('1e', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('1e', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('1e', 'CCG - Registration or Residence; IMD', 'CCG - Registration or Residence', 'IMD', Null),
 ('1e', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('1e', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_T1', Null),
 ('1e', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('1e', 'IMD', 'IMD', Null, Null),
 ('1e', 'IMD Quintiles', 'IMD_QUIN', Null, Null),
 ('1e', 'Provider', 'Provider', Null, Null),
 ('1e', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('1e', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('1e', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('1e', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('1e', 'CCG - Registration or Residence; Service Type Group', 'CCG - Registration or Residence', 'SERVICE_TYPE', Null),
 ('1e', 'Service Type as Reported to MHSDS', 'SERVICE_TYPE', Null, Null),
 ('1e', 'Service Type as Reported to MHSDS; Age Group (Higher Level)', 'SERVICE_TYPE', 'AGE_HL', Null),
 ('1e', 'Service Type as Reported to MHSDS; Ethnicity (Higher Level)', 'SERVICE_TYPE', 'ETHNIC_HL', Null),
 ('1e', 'Service Type as Reported to MHSDS; Gender', 'SERVICE_TYPE', 'GENDER', Null),
 ('1e', 'Service Type as Reported to MHSDS; IMD Quintiles', 'SERVICE_TYPE', 'IMD_QUIN', Null),
 
 ---Chapter 4---
 ('4a', 'Bed Type as Reported to MHSDS; Age Group (Higher Level)', 'BED_TYPE', 'AGE_HL', Null),
 ('4a', 'Bed Type as Reported to MHSDS; Ethnicity (Higher Level)', 'BED_TYPE', 'ETHNIC_HL', Null),
 ('4a', 'Bed Type as Reported to MHSDS; IMD Quintiles', 'BED_TYPE', 'IMD_QUIN', Null),
 ('4a', 'Bed Type as Reported to MHSDS; Gender', 'BED_TYPE', 'GENDER', Null),
 ('4a', 'Bed Type as Reported to MHSDS', 'BED_TYPE', Null, Null),
 ('4a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('4a', 'CCG - Registration or Residence; Bed Type Group', 'CCG - Registration or Residence', 'BED_TYPE', Null),
 ('4a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('4a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('4a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('4a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('4a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL', Null),
 ('4a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('4a', 'IMD', 'IMD', Null, Null),
 ('4a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('4a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('4a', 'Provider; Bed Type Group', 'Provider', 'BED_TYPE', Null),
 ('4a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('4a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('4a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 
 ---Chapter 5---
 ('5a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('5a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('5a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('5a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('5a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('5a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL', Null),
 ('5a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('5a', 'IMD', 'IMD', Null, Null),
 ('5a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('5a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('5a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('5a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('5a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('5a', 'Bed Type as Reported to MHSDS', 'BED_TYPE', Null, Null),
 ('5a', 'Bed Type as Reported to MHSDS; Age Group (Higher Level)', 'BED_TYPE', 'AGE_HL', Null),
 ('5a', 'Bed Type as Reported to MHSDS; IMD Quintiles', 'BED_TYPE', 'IMD_QUIN', Null),
 ('5a', 'Bed Type as Reported to MHSDS; Ethnicity (Higher Level)', 'BED_TYPE', 'ETHNIC_HL', Null),
 
 ---Chapter 7---
 ('7a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('7b', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('7a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('7b', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('7a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('7b', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('7a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('7b', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('7a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_restraint', Null),
 ('7b', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_restraint', Null),
 ('7a', 'IMD', 'IMD', Null, Null),
 ('7b', 'IMD', 'IMD', Null, Null),
 ('7a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('7b', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('7a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('7b', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('7a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('7b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('7a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('7b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('7a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('7b', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 
 ---Chapters 8 and 9---
 ('9a', 'CCG - Registration or Residence; Age Group (Lower Level)', 'CCG - Registration or Residence', 'CONTACTS_AGE_GROUP', Null),
 ('9a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('9a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('9a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('9a', 'Provider; Age Group (Lower Level)', 'Provider', 'CONTACTS_AGE_GROUP', Null),
 ('9a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('9a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('9a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 
 ---Chapter 10---
 ('10a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('10b', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('10c', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('10d', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('10e', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('10f', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('10a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10b', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10c', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10d', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10e', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10f', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('10a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10b', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10c', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10d', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10e', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10f', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('10a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('10b', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('10c', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('10d', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('10e', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('10f', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('10a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('10b', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('10c', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('10d', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('10e', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('10f', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('10a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('10b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('10c', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('10d', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('10e', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('10f', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('10a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('10b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('10c', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('10d', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('10e', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('10f', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('10a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('10b', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('10c', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('10d', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('10e', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('10f', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 
 ---Chapter 13---
 ('13a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null), 
 ('13b', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('13c', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null), 
 ('13a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('13b', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('13c', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('13a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('13b', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('13c', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('13a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('13b', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('13c', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('13a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('13b', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('13c', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('13a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('13b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('13c', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('13a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('13b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('13c', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('13a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('13b', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('13c', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null)

# COMMAND ----------

 %sql
 INSERT INTO TABLE $db_output.measure_level_type_mapping VALUES
 ---additional breakdowns for each metric
 ---Chapter 11---
 ('11a', 'England', 'England', Null, Null),
 ('11a', 'Age Group (Lower Level)', 'AGE_LL_perinatal', Null, Null),
 ('11a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null),
 ('11a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('11a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('11a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('11a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('11a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('11a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_perinatal', Null),
 ('11a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('11a', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'AGE_LL_perinatal', Null),
 ('11a', 'IMD', 'IMD', Null, Null),
 ('11a', 'IMD Quintiles', 'IMD_QUIN', Null, Null),
 ('11a', "IMD; Age Group (Lower Level)", 'IMD', 'AGE_LL_perinatal', Null),
 ('11a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('11a', 'STP', 'STP', Null, Null),
 ('11a', 'LAD/UA', 'LADUA', Null, Null),
 ('11a', 'Provider', 'Provider', Null, Null),
 ('11a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('11a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('11a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 --Rates
 ('11b', 'England', 'England', Null, Null),
 ('11b', 'Age Group (Lower Level)', 'AGE_LL_perinatal', Null, Null),
 ('11b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 
 ---Chapter 12---
 ('12a', 'England', 'England', Null, Null),
 ('12b', 'England', 'England', Null, Null),
 ('12c', 'England', 'England', Null, Null),
 ('12a', 'Age Group (Lower Level)', 'AGE_LL_72hfollow', Null, Null),
 ('12b', 'Age Group (Lower Level)', 'AGE_LL_72hfollow', Null, Null),
 ('12c', 'Age Group (Lower Level)', 'AGE_LL_72hfollow', Null, Null),
 ('12a', 'Age Group (Higher Level)', 'AGE_HL', Null, Null),
 ('12b', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('12c', 'Age Group (Higher Level)', 'AGE_HL', Null, Null), 
 ('12a', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('12b', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('12c', 'CCG - Registration or Residence', 'CCG - Registration or Residence', Null, Null),
 ('12a', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('12b', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('12c', 'CCG - Registration or Residence; Age Group (Higher Level)', 'CCG - Registration or Residence', 'AGE_HL', Null),
 ('12a', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('12b', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('12c', 'CCG - Registration or Residence; Ethnicity (Higher Level)', 'CCG - Registration or Residence', 'ETHNIC_HL', Null),
 ('12a', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('12b', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('12c', 'CCG - Registration or Residence; Gender', 'CCG - Registration or Residence', 'GENDER', Null),
 ('12a', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('12b', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('12c', 'CCG - Registration or Residence; IMD Quintiles', 'CCG - Registration or Residence', 'IMD_QUIN', Null),
 ('12a', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('12b', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('12c', 'Ethnicity (Higher Level)', 'ETHNIC_HL', Null, Null), 
 ('12a', 'Ethnicity (Higher Level); Age Group (Higher Level)', 'ETHNIC_HL', 'AGE_HL', Null),
 ('12b', 'Ethnicity (Higher Level); Age Group (Higher Level)', 'ETHNIC_HL', 'AGE_HL', Null),
 ('12b', 'Ethnicity (Higher Level); Age Group (Higher Level)', 'ETHNIC_HL', 'AGE_HL', Null),
 ('12a', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_72hfollow', Null),
 ('12b', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_72hfollow', Null),
 ('12c', 'Ethnicity (Higher Level); Age Group (Lower Level)', 'ETHNIC_HL', 'AGE_LL_72hfollow', Null),
 ('12a', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('12b', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('12c', 'Ethnicity (Lower Level)', 'ETHNIC_LL', Null, Null), 
 ('12a', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'AGE_LL_72hfollow', Null),
 ('12b', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'AGE_LL_72hfollow', Null),
 ('12c', "Ethnicity (Lower Level); Age Group (Lower Level)", 'ETHNIC_LL', 'AGE_LL_72hfollow', Null),
 ('12a', 'Gender', 'GENDER', Null, Null),
 ('12b', 'Gender', 'GENDER', Null, Null),
 ('12c', 'Gender', 'GENDER', Null, Null),
 ('12a', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_72hfollow', Null),
 ('12b', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_72hfollow', Null),
 ('12c', "Gender; Age Group (Lower Level)", 'GENDER', 'AGE_LL_72hfollow', Null),
 ('12a', 'IMD', 'IMD', Null, Null),
 ('12b', 'IMD', 'IMD', Null, Null),
 ('12c', 'IMD', 'IMD', Null, Null),
 ('12a', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('12b', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('12c', 'IMD Quintiles', 'IMD_QUIN', Null, Null), 
 ('12a', "IMD; Age Group (Lower Level)", 'IMD', 'AGE_LL_72hfollow', Null),
 ('12b', "IMD; Age Group (Lower Level)", 'IMD', 'AGE_LL_72hfollow', Null),
 ('12c', "IMD; Age Group (Lower Level)", 'IMD', 'AGE_LL_72hfollow', Null),
 ('12a', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('12b', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('12c', 'Commissioning Region', 'COMM_REGION', Null, Null),
 ('12a', 'STP', 'STP', Null, Null),
 ('12b', 'STP', 'STP', Null, Null),
 ('12c', 'STP', 'STP', Null, Null),
 ('12a', 'LAD/UA', 'LADUA', Null, Null),
 ('12b', 'LAD/UA', 'LADUA', Null, Null),
 ('12c', 'LAD/UA', 'LADUA', Null, Null),
 ('12a', 'Provider', 'Provider', Null, Null),
 ('12b', 'Provider', 'Provider', Null, Null),
 ('12c', 'Provider', 'Provider', Null, Null),
 ('12a', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('12b', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('12c', 'Provider; Age Group (Higher Level)', 'Provider', 'AGE_HL', Null),
 ('12a', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('12b', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('12c', 'Provider; Ethnicity (Higher Level)', 'Provider', 'ETHNIC_HL', Null),
 ('12a', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('12b', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('12c', 'Provider; Gender', 'Provider', 'GENDER', Null),
 ('12a', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('12b', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null),
 ('12c', 'Provider; IMD Quintiles', 'Provider', 'IMD_QUIN', Null)

# COMMAND ----------

db_output = dbutils.widgets.get('db_output') #db_output widget as python variable
#measure and breakdown mapping spark dataframe
mltm_df = spark.table(f'{db_output}.measure_level_type_mapping')
#breakdown and level mapping spark datafrme
ref_master_df = spark.table(f'{db_output}.ref_master')
#join spark dataframes together on breakdown type
joined_df = (
  mltm_df.alias('lhs')
  .join(
    ref_master_df.alias('rhs'), ref_master_df.type == mltm_df.type
  )
  .select('lhs.metric','lhs.breakdown', 'lhs.type','lhs.cross_join_tables_l2','lhs.cross_join_tables_l3', 'rhs.level','rhs.level_description')
)
joined_df.write.saveAsTable(f"{db_output}.joined_df_v") #joined spark dataframe as permanent table
mltm_df.write.saveAsTable(f"{db_output}.mltm_df_v") ##measure and breakdown mapping spark dataframe as permanent table

# COMMAND ----------

 %sql
 OPTIMIZE $db_output.ref_master
 ZORDER BY (type);
 
 DROP TABLE IF EXISTS $db_output.level1_df_v;
 CREATE TABLE $db_output.level1_df_v USING DELTA AS
 SELECT *
 FROM $db_output.tmp_joined_df
 WHERE cross_join_tables_l2 IS NULL AND cross_join_tables_l3 IS NULL; ---level 1 breakdowns only i.e. England, Provider
 
 DROP TABLE IF EXISTS $db_output.level_2_stg1_df_v;
 CREATE TABLE $db_output.level_2_stg1_df_v USING DELTA AS
 SELECT *
 FROM $db_output.tmp_mltm_df_v
 WHERE cross_join_tables_l2 IS NOT NULL AND cross_join_tables_l3 IS NULL; ---level 2 breakdowns oly i.e. England; Age Group, Provider; Age Group

# COMMAND ----------

 %sql
 TRUNCATE TABLE $db_output.csv_master

# COMMAND ----------

#insert level 1 breakdowns for each metric into $db_output.csv_master
spark.sql(f"""
INSERT INTO {db_output}.csv_master
SELECT			 
'{rp_startdate}' AS REPORTING_PERIOD_START
,'{rp_enddate}' AS REPORTING_PERIOD_END
,'Final' AS STATUS
,breakdown AS BREAKDOWN
,LEVEL AS LEVEL_ONE
,LEVEL_DESCRIPTION AS LEVEL_ONE_DESCRIPTION
,'NONE' AS LEVEL_TWO
,'NONE' AS LEVEL_TWO_DESCRIPTION
,'NONE' AS LEVEL_THREE
,'NONE' AS LEVEL_THREE_DESCRIPTION
,metric AS METRIC
FROM {db_output}.level1_df_v""")

# COMMAND ----------

#insert level 2 breakdowns for each metric into $db_output.csv_master
level_2_stg1_df = spark.sql(f"select * from {db_output}.level_2_stg1_df_v")
for record in level_2_stg1_df.collect():
  print(record)
  level2_qry = f"""
  INSERT INTO {db_output}.csv_master
   SELECT			 
    '{rp_startdate}' AS REPORTING_PERIOD_START
    ,'{rp_enddate}' AS REPORTING_PERIOD_END
    ,'Final' AS STATUS
    ,l1.breakdown AS BREAKDOWN
    ,L1.level AS LEVEL_ONE
    ,L1.level_description AS LEVEL_ONE_DESCRIPTION
    ,L2.LEVEL AS LEVEL_TWO
    ,L2.LEVEL_DESCRIPTION AS LEVEL_TWO_DESCRIPTION
    ,'NONE' AS LEVEL_THREE
    ,'NONE' AS LEVEL_THREE_DESCRIPTION
    ,L1.metric AS METRIC
    FROM 
    (SELECT * FROM {db_output}.tmp_joined_df WHERE type = '{record['type']}' AND metric = '{record['metric']}' AND breakdown = '{record['breakdown']}') AS L1
    CROSS JOIN (SELECT * FROM {db_output}.ref_master where type = '{record['cross_join_tables_l2']}') AS L2
  """
  spark.sql(level2_qry)

# COMMAND ----------

#insert level 3 breakdowns for each metric into $db_output.csv_master
level_3_stg1_df = spark.sql(f"select * from {db_output}.tmp_mltm_df_v WHERE cross_join_tables_l2 IS NOT NULL AND cross_join_tables_l3 IS NOT NULL")
for record in level_3_stg1_df.collect():
  print(record)
  level3_qry = f"""
  INSERT INTO {db_output}.csv_master
   SELECT			 
    '{rp_startdate}' AS REPORTING_PERIOD_START
    ,'{rp_enddate}' AS REPORTING_PERIOD_END
    ,'Final' AS STATUS
    ,l1.breakdown AS BREAKDOWN
    ,L1.level AS LEVEL_ONE
    ,L1.level_description AS LEVEL_ONE_DESCRIPTION
    ,L2.LEVEL AS LEVEL_TWO
    ,L2.LEVEL_DESCRIPTION AS LEVEL_TWO_DESCRIPTION
    ,L3.LEVEL AS LEVEL_THREE
    ,l3.LEVEL_DESCRIPTION AS LEVEL_THREE_DESCRIPTION
    ,L1.metric AS METRIC
    FROM 
    (SELECT * FROM {db_output}.tmp_joined_df WHERE type = '{record['type']}' AND metric = '{record['metric']}' AND breakdown = '{record['breakdown']}') AS L1
    CROSS JOIN (SELECT * FROM {db_output}.ref_master where type = '{record['cross_join_tables_l2']}') AS L2
    CROSS JOIN (SELECT * FROM {db_output}.ref_master where type = '{record['cross_join_tables_l3']}') AS L3
  """
  spark.sql(level3_qry)

# COMMAND ----------

 %sql
 DROP TABLE IF EXISTS $db_output.tmp_joined_df;
 DROP TABLE IF EXISTS $db_output.tmp_mltm_df_v;
 DROP TABLE IF EXISTS $db_output.level1_df_v;
 DROP TABLE IF EXISTS $db_output.level_2_stg1_df_v;